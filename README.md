# 1t-DE-4.4-BigData-T2
Задание на курсах 1t "Инженер данных". 4.4 Введение в Hadoop. Задание 2
***Задача:
!Аналитики хотят сводную статистику на уровне каждой компании и на уровне каждого года получить целевую возрастную группу подписчиков — то есть, возрастную группу, представители которой чаще всего совершали подписку именно в текущий год на текущую компанию

Решение:
1)Загрузка данных из репозитория: GitHub - sultanmurad/csv_files.
    Загружены 3 csv-файла:
    •	customers.csv
    •	organizations.csv
    •	people.csv

2)Эти файлы будут подвержены анализу. Необходимо произвести их предобратботку.

        Примечание:
        Используйте средства python + pandas.

    2.1)Добавьте в каждый файл столбец с номером группы таким образом, чтобы файл был разделен на 10 групп.

    2.2)В файл customers.csv добавьте столбец с номером года, в который была совершена подписка (Subscription Date).

3)Загрузите полученные файлы на hdfs.
    3.1)- Подкючаемся к интерфейсу командной строки в контенйере datanode_1
        docker exec -it 3e5a6adcdd4279ec1d01361abf36f61e6653cf83ff6eb8ed1c6b6622884b798c bash    
    3.2)- Создаём каталог 4.4-Task2 в каталоге /home:
        mkdir /home/4.4-Task2
    3.3)- Переносим в контейнер скачанные файлы (команды из терминала хостовой системы):
        docker cp './csv_changed' 3e5a6adcdd42:'/home/4.4-Task2'
    3.4)- Загружаем полученные файлы на hdfs в вашу личную папку (работаем в контейнере).
        3.4.1)Создадим новый каталог 4.4-Task2 в каталоге пользователя в HDFS:
        hadoop fs -mkdir /user/loghue/4.4-Task2
        3.4.2) Копируем файлы из локальной системы (контейнер с узлом DATANODE) в созданный каталог на HDFS:
        hadoop fs -put /home/4.4-Task2/* /user/loghue/4.4-Task2

Каталог csv_changed с файлами скопирован в личную папку на HDFS

4)	Теперь ваша задача следующая: аналитики хотят сводную статистику на уровне каждой компании и на уровне каждого года получить целевую возрастную группу подписчиков — то есть, возрастную группу, представители которой чаще всего совершали подписку именно в текущий год на текущую компанию. 

        Примечание:
        Все операции необходимо выполнить в Hive. Работать с Hive можно через интерфейс HUE, если перейти в раздел «Query», или выбрав нужный пункт в разделе «Editor».

4.1)Нужно создать под каждый csv-файл отдельную таблицу.

        Примечание:
        Для оптимизации используйте свои знания партиционирования и бакетирования. 

4.2)Затем на основе 3-х таблиц собрать витрину, которая решает поставленную задачу. 
    -- Задача: надо сводную статистику на уровне каждой компании и на уровне каждого года получить целевую возрастную группу подписчиков — то есть, возрастную группу, представители которой чаще всего совершали подписку именно в текущий год на текущую компанию.
        
        Примечание:
        В качестве результата предоставьте код SQL-запросов для создания исходных таблиц и создания итоговой витрины.

    -- Пример:
        Company	Year	Age_group
        Apple	2023	0-18
        Xiaomi	2023	25-35

ПЛАН ЗАПРОСА для создания витрины:

1. Соединенить партиционированную таблицу custumers.
2. Создать сводную таблицу, в которой указаны возрастные группы покупателей.
3. Создать таблицу, представлящую собой требуемую витрину с указанием атрибутов:
 	компания, год подписки, возрастная группа, количество покупателей в указанной возрастной группе.

5)В качестве результата необходимо предоставить:
    •	скрипты на python+pandas для предобработки исходных файлов
        Файл: 4.4-T2-preprocessing.py
    
    •	код загрузки файлов на hdfs
        Файл: 4.4-T2-HDFS-cmd.txt

    •	код всех запросов для создания таблиц и план запроса для формирования витрины.
        Файлы:  4.4-T2-Hive_quaries.sql
                4.4-T2-Query_plan_nat.txt

6)Результат выполнения задания необходимо выложить в github/gitlab и указать ссылку на Ваш репозиторий (не забудьте: репозиторий должен быть публичным)

Ссылка:
    https://github.com/vkalt12/1t-DE-4.4-BigData-T2.git

